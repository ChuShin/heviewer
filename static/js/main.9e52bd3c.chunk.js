(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{28:function(e,t,_){},41:function(module,__webpack_exports__,__webpack_require__){"use strict";var _Users_chk512_JSprojects_heviewer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(18),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__),d3_array__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(94),d3_array__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(95),d3_array__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(96),d3_selection__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(8),d3_collection__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(25),d3_scale__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(9),d3_axis__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(46),d3_zoom__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(15),d3__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(45),file_saver__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(43),file_saver__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(file_saver__WEBPACK_IMPORTED_MODULE_11__),_index_css__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(28),_index_css__WEBPACK_IMPORTED_MODULE_12___default=__webpack_require__.n(_index_css__WEBPACK_IMPORTED_MODULE_12__),react_loader_spinner__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(37),react_loader_spinner__WEBPACK_IMPORTED_MODULE_13___default=__webpack_require__.n(react_loader_spinner__WEBPACK_IMPORTED_MODULE_13__),lodash__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(44),lodash__WEBPACK_IMPORTED_MODULE_14___default=__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_14__),margin={top:20,right:20,bottom:50,left:20},width=1500,height=400-margin.top-margin.bottom,chrDistance=5e6,barWidth=20;function getGenomeSummary(e){var t,_=Object(d3_collection__WEBPACK_IMPORTED_MODULE_6__.a)().key(function(e){return e.group}).entries(e),a=0,r={};for(t=0;t<_.length;t++){var n=Object(d3_array__WEBPACK_IMPORTED_MODULE_2__.a)(_[t].values.map(function(e){return e.pos}));r[_[t].key]={name:_[t].key,chrSize:n,offset:a},a+=n+chrDistance}return r.map_size=a,r}function getSampleSummary(e){var t,_=Object(d3_collection__WEBPACK_IMPORTED_MODULE_6__.a)().key(function(e){return e.sample}).entries(e),a={};for(t=0;t<_.length;t++)a[_[t].key]={name:_[t].key,mean:Object(d3_array__WEBPACK_IMPORTED_MODULE_3__.a)(_[t].values.map(function(e){return e.covA+e.covB}))/2,sd:Object(d3_array__WEBPACK_IMPORTED_MODULE_4__.a)(_[t].values.map(function(e){return e.covA}))/2};return a}function heColor(e,t,_,a){var r=["#FF2400","#E56717","#FDD017","#5FFB17","#4EE2EC","#0041C2","#E3319D","#9C67CA","#452E5A"],n=(_-e)/t,o=(a-e)/t;return n<=-2&&o<=-2?r[0]:n<-2&&o>-2&&o<2?r[1]:n<=-2&&o>=2?r[2]:n>-2&&n<2&&o<-2?r[3]:n>-2&&n<2&&o>-2&&o<2?r[4]:n>-2&&n<2&&o>2?r[5]:n<=-2&&o>=2?r[6]:n<-2&&o>-2&&o<2?r[7]:n>2&&o>2?r[8]:void 0}function getSVGString(e){e.setAttribute("xlink","http://www.w3.org/1999/xlink");var t=(new XMLSerializer).serializeToString(e);return t=(t=t.replace(/(\w+)?:?xlink=/g,"xmlns:xlink=")).replace(/NS\d+:href/g,"xlink:href")}function svgString2Image(e,t,_,a){var r="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e))),n=document.createElement("canvas"),o=n.getContext("2d");n.width=t,n.height=_;var s=new Image;s.onload=function(){o.clearRect(0,0,t,_),o.drawImage(s,0,0,t,_),n.toBlob(function(e){var t=Math.round(e.length/1024)+" KB";a&&a(e,t)})},s.src=r}function writeDownloadLink(e,t){try{new Blob}catch(a){alert("blob not supported")}var _=new Blob([e],{type:"image/svg+xml"});Object(file_saver__WEBPACK_IMPORTED_MODULE_11__.saveAs)(_,t)}function setGenome(e,t,_,a,r){var n=Object(d3_selection__WEBPACK_IMPORTED_MODULE_5__.a)(e.current);n.selectAll("*").remove();var o=r.key,s=r.values,l=Object(d3_scale__WEBPACK_IMPORTED_MODULE_7__.a)().domain([0,7e7]).range([0,height]),c=Object(d3_axis__WEBPACK_IMPORTED_MODULE_8__.b)().scale(l).ticks(6).tickFormat(function(e,t){return e/1e6});n.append("g").attr("transform","translate(50, 20)").style("font","12px helvetica").call(c),s.forEach(function(e,r){var s=e.values.map(function(e){return[e.covA,e.pos]}),c=e.values.map(function(e){return[-1*e.covB,e.pos]}),i=_[o].mean,d=t(a[e.key].offset)+100,u=Object(d3_scale__WEBPACK_IMPORTED_MODULE_7__.a)().domain([-3*i,3*i]).range([-40,40]);n.append("g").attr("transform","translate(50, 20)").selectAll("dot").data(s).enter().append("circle").attr("cx",function(e){return d+u(e[0])}).attr("cy",function(e){return l(e[1])}).attr("r",1.5).style("fill","#808080"),n.append("g").attr("transform","translate(50, 20)").selectAll("dot").data(c).enter().append("circle").attr("cx",function(e){return d+u(e[0])}).attr("cy",function(e){return l(e[1])}).attr("r",1.5).style("fill","#808080"),n.append("line").attr("transform","translate(50, 20)").attr("x1",d).attr("y1",l(0)).attr("x2",d).attr("y2",l(a[e.key].chrSize)).style("stroke","black").style("stroke-width",2),n.append("line").attr("transform","translate(50, 20)").attr("x1",d+u(i)).attr("y1",l(0)).attr("x2",d+u(i)).attr("y2",l(a[e.key].chrSize)).style("stroke","#9933a2").style("stroke-width",2),n.append("line").attr("transform","translate(50, 20)").attr("x1",d-u(i)).attr("y1",l(0)).attr("x2",d-u(i)).attr("y2",l(a[e.key].chrSize)).style("stroke","#69b3a2").style("stroke-width",2)})}function drawHeatmap(e,t,_,a,r,n,o){var s=e.append("g").attr("transform","translate(80,0)");_.forEach(function(e,_){var l=e.values.map(function(e){return[e.pos,heColor(a[t].mean,a[t].sd,e.covA,e.covB)]}),c=n(r[e.key].offset);s.append("g").append("rect").attr("rx",2).attr("ry",2).attr("x",c).attr("y",o).attr("width",n(r[e.key].chrSize)).attr("height",barWidth).style("fill","#FF2400AF").style("fill-opacity",.1),s.append("g").selectAll("line").data(l).enter().append("line").style("stroke",function(e){return e[1]}).attr("chrGroup",e.key).attr("value",function(e){return e[0]}).attr("x1",function(e){return c+n(e[0])}).attr("y1",function(e){return o}).attr("x2",function(e){return c+n(e[0])}).attr("y2",function(e){return o+barWidth})})}function drawChrLabels(e,t,_){var a=Object(d3_scale__WEBPACK_IMPORTED_MODULE_7__.a)().domain([0,t.map_size]).range([0,_]),r="";for(var n in t)if(t[n].hasOwnProperty("offset"))if(t[n].offset>0){var o=(t[r].offset+t[n].offset)/2;e.attr("transform","translate(80,0)").append("text").attr("class","xLabel").attr("x",a(o)).attr("y",15).attr("text-anchor","middle").text(r).style("font","16px helvetica").style("font-weight","bold").style("fill","rgb(0, 65, 194)"),r=n}else r=n;var s=t[r].offset+t[r].chrSize/2;e.attr("transform","translate(80,0)").append("text").attr("class","xLabel").attr("x",a(s)).attr("y",15).attr("text-anchor","middle").text(r).style("font","16px helvetica").style("font-weight","bold").style("fill","rgb(0, 65, 194)")}function drawChrAxis(e,t,_,a,r){var n=Object(d3_scale__WEBPACK_IMPORTED_MODULE_7__.a)().domain([0,t.map_size]).range([0,_]),o=a-40;for(var s in e.attr("transform","translate(80, "+o+")"),t){var l=t[s];if(l.hasOwnProperty("offset")&&l.offset>=0){var c=Object(d3_scale__WEBPACK_IMPORTED_MODULE_7__.a)().domain([0,l.chrSize]).range([n(l.offset),n(l.chrSize+l.offset)]);e.append("g").call(Object(d3_axis__WEBPACK_IMPORTED_MODULE_8__.a)(c).ticks(r).tickFormat(function(e,t){return e/1e6}))}}}var GenomeGroup=function GenomeGroup(_ref2){var data=_ref2.data,gglinear=Object(react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null),ggdot=Object(react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null),_useState=Object(react__WEBPACK_IMPORTED_MODULE_1__.useState)(null),_useState2=Object(_Users_chk512_JSprojects_heviewer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__.a)(_useState,2),dotplot=_useState2[0],setDotPlot=_useState2[1],_useState3=Object(react__WEBPACK_IMPORTED_MODULE_1__.useState)(null),_useState4=Object(_Users_chk512_JSprojects_heviewer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__.a)(_useState3,2),setSelectedSample=_useState4[1],_useState5=Object(react__WEBPACK_IMPORTED_MODULE_1__.useState)("400"),_useState6=Object(_Users_chk512_JSprojects_heviewer_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__.a)(_useState5,2),ggHeight=_useState6[0],setGgHeight=_useState6[1];return Object(react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(function(){if(data&&gglinear.current){var handleSampleChange=function(e,t){var _=e.key;setDotPlot(_),setGenome(ggdot,xScale,sampleSummary,genomeSummary,e);var a=svg.selectAll(".sampleBtn");a.style("fill","#525252"),a.filter(function(e,_){return _===t}).style("fill","blue")},zoomed=function(e){var t=e.transform;heatMaps.attr("transform",t)},genomeSummary=getGenomeSummary(data),sampleSummary=getSampleSummary(data);console.log(genomeSummary),console.log(sampleSummary);var xScale=Object(d3_scale__WEBPACK_IMPORTED_MODULE_7__.a)().domain([0,genomeSummary.map_size]).range([0,width-margin.right]),yScale=Object(d3_scale__WEBPACK_IMPORTED_MODULE_7__.a)().domain([0,300]).range([0,height]),svg=Object(d3_selection__WEBPACK_IMPORTED_MODULE_5__.a)(gglinear.current);svg.selectAll("*").remove(),svg=svg.append("g").attr("transform","translate(".concat(margin.left,", ").concat(margin.top,")"));var heData=Object(d3_collection__WEBPACK_IMPORTED_MODULE_6__.a)().key(function(e){return e.sample}).key(function(e){return e.group}).entries(data),numSamples=lodash__WEBPACK_IMPORTED_MODULE_14__.size(heData),heatmapHeight=22*(numSamples+3);setGgHeight(heatmapHeight);var chrLabels=svg.append("g");drawChrLabels(chrLabels,genomeSummary,width-margin.right);var heatmapAxis=svg.append("g");drawChrAxis(heatmapAxis,genomeSummary,width-margin.right,heatmapHeight);var heatMaps=svg.append("g"),zooms=Object(d3_zoom__WEBPACK_IMPORTED_MODULE_9__.a)().scaleExtent([5,5]).on("zoom",zoomed),isZoomed=0;heatMaps.on("dblclick",function(event){var curTransform=Object(d3_zoom__WEBPACK_IMPORTED_MODULE_9__.c)(heatMaps.node()),factor=10,leftPad=80,plotWidth=width-margin.right,xPos=Object(d3__WEBPACK_IMPORTED_MODULE_10__.a)(event)[0],xPosZoomed=factor*xPos,lowerBound=-1*(factor-1)*leftPad,upperBound=-1*factor*plotWidth+900,transformation="";0==isZoomed?(transformation=xPos<210?lowerBound:xPos>1460?upperBound:plotWidth/2-xPosZoomed,heatMaps.transition().duration(750).attr("transform","translate("+transformation+",0) scale(10,1)"),chrLabels.remove(),chrLabels=svg.append("g"),drawChrLabels(chrLabels,genomeSummary,factor*plotWidth),chrLabels.transition().duration(750).attr("transform","translate("+eval(transformation+factor*leftPad)+",0)"),heatmapAxis.remove(),heatmapAxis=svg.append("g"),drawChrAxis(heatmapAxis,genomeSummary,factor*(width-margin.right),heatmapHeight,20),heatmapAxis.transition().duration(750).attr("transform","translate("+eval(transformation+factor*leftPad)+","+eval(heatmapHeight-40)+")"),isZoomed=1):(heatMaps.transition().duration(750).call(zooms.transform,d3_zoom__WEBPACK_IMPORTED_MODULE_9__.b),chrLabels.remove(),chrLabels=svg.append("g"),drawChrLabels(chrLabels,genomeSummary,plotWidth),heatmapAxis.remove(),heatmapAxis=svg.append("g"),drawChrAxis(heatmapAxis,genomeSummary,plotWidth,heatmapHeight),isZoomed=0)}),heData.forEach(function(e,t){var _=e.key,a=e.values,r=yScale("".concat(margin.top+barWidth*t));svg.append("g").append("rect").attr("class","sampleBtn").attr("rx",4).attr("ry",4).attr("x",xScale(0)).attr("y",r).attr("width",70).attr("height",barWidth),svg.append("text").attr("class","y label").attr("x",5).attr("y",r+yScale(barWidth)-8).text(_).style("font","10px helvetica").style("fill","white").on("click",function(){handleSampleChange(e,t)}),drawHeatmap(heatMaps,_,a,sampleSummary,genomeSummary,xScale,r)}),handleSampleChange(heData[0],0),Object(d3_selection__WEBPACK_IMPORTED_MODULE_5__.a)("#saveHeatMap").on("click",function(){writeDownloadLink('<svg height="500" width="1000">'+getSVGString(svg.node())+"</svg>","heatmap.svg")}),Object(d3_selection__WEBPACK_IMPORTED_MODULE_5__.a)("#saveScatter").on("click",function(){writeDownloadLink('<svg height="500" width="1000">'+getSVGString(Object(d3_selection__WEBPACK_IMPORTED_MODULE_5__.a)(ggdot.current).node())+"</svg>","scatterplot.svg")})}},[data]),react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("div",null,react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("div",{className:"actionPanel"},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("button",{className:"saveBtn",id:"saveHeatMap"},"Export Heatmap"),react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("button",{className:"saveBtn",id:"saveScatter"},"Export ScatterPlot")),react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("div",{className:"ggContainer"},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("svg",{className:"GGLinear",width:"1600",height:ggHeight,ref:gglinear})),react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("h3",null,dotplot),react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("div",{className:"ggContainer"},react__WEBPACK_IMPORTED_MODULE_1___default.a.createElement("svg",{className:"GGDot",width:width+margin.left+margin.right,height:"400",ref:ggdot})))};__webpack_exports__.a=GenomeGroup},65:function(e,t,_){e.exports=_(93)},93:function(e,t,_){"use strict";_.r(t);var a=_(0),r=_.n(a),n=_(40),o=_.n(n),s=(_(28),_(18)),l=(_(37),_(98)),c=_(41);function i(e){return{sample:e.sample,group:e.group,pos:+e.pos,covA:parseFloat(e.covA),covB:parseFloat(e.covB)}}var d=function(){var e=Object(a.useState)(null),t=Object(s.a)(e,2),_=t[0],n=t[1];return Object(a.useEffect)(function(){document.getElementById("file_input").addEventListener("change",function(e){var t=e.target.files[0],_=new FileReader;_.onload=function(e){Object(l.a)(e.target.result,i).then(function(e){n(e)})},_.readAsDataURL(t)},!1)},[]),r.a.createElement("div",null,r.a.createElement("input",{type:"file",id:"file_input",accept:".csv"}),r.a.createElement(c.a,{data:_}))},u=function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"header"},"HExviewer"),r.a.createElement("div",{className:"heContainer"},r.a.createElement(d,null)))},E=function(e){e&&e instanceof Function&&_.e(3).then(_.bind(null,102)).then(function(t){var _=t.getCLS,a=t.getFID,r=t.getFCP,n=t.getLCP,o=t.getTTFB;_(e),a(e),r(e),n(e),o(e)})};o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(u,null)),document.getElementById("root")),E()}},[[65,1,2]]]);
//# sourceMappingURL=main.9e52bd3c.chunk.js.map